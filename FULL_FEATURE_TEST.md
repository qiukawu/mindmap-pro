# 🧪 MindFlow Pro 完整功能测试指南

## 📋 概述

本指南详细说明如何验证 MindFlow Pro 的所有核心功能是否正常工作。

**应用入口**: `mindmap.htm` （推荐）或 `index.html`

---

## 1️⃣ 基础功能测试

### 1.1 应用启动
- [ ] 打开浏览器，访问 `http://localhost:3000/mindmap.htm`
- [ ] 页面加载完成，显示思维导图编辑器
- [ ] 浏览器控制台（F12）无红色错误信息
- [ ] 加载示例数据：显示"MindFlow Pro" 根节点

### 1.2 节点操作
- [ ] **创建节点**：右键单击空白区域 → 新建节点
- [ ] **编辑文本**：双击节点 → 输入文本 → Enter 确认
- [ ] **删除节点**：选中节点 → Delete 键删除
- [ ] **颜色编辑**：双击节点 → 改变背景颜色
- [ ] **拖拽排序**：拖拽节点改变位置和层级关系
- [ ] **多选操作**：Ctrl+Click 选多个节点 → 可批量删除

### 1.3 视图操作
- [ ] **缩放**：鼠标滚轮放大/缩小
- [ ] **平移**：Ctrl+拖拽或中键拖拽移动视图
- [ ] **居中**：工具栏"居中"按钮
- [ ] **全屏**：按 F 键进入/退出全屏
- [ ] **主题切换**：工具栏切换浅色/深色主题

---

## 2️⃣ AI 功能测试

### 2.1 本地模式（无需 API）
- [ ] **分析功能**：选中节点 → "AI" → "分析文本" → 生成建议
- [ ] **扩展功能**：选中节点 → "AI" → "扩展内容" → 生成子节点
- [ ] **优化功能**：选中节点 → "AI" → "内容优化" → 输出优化文本
- [ ] **本地生成**：无 API 配置时仍能生成默认建议

### 2.2 API 配置（支持所有 OpenAI 兼容模型）
- [ ] 打开 **API 设置** 弹窗
- [ ] 输入 API 地址（例如：`https://api.openai.com/v1/chat/completions`）
- [ ] 输入 API 密钥
- [ ] **模型选择**：选择预设模型或输入自定义模型
  - [ ] 支持：`gpt-4`、`gpt-4-turbo`、`gpt-3.5-turbo`
  - [ ] 支持：`claude-3-opus`、`claude-3-sonnet`（Claude API）
  - [ ] 支持：`qwen-plus`、`qwen-turbo`（通义千问）
  - [ ] 支持：`deepseek-chat`（DeepSeek）
  - [ ] 支持自定义输入任意模型名称
- [ ] 点击 **测试连接** 验证 API 可用
- [ ] 保存配置
- [ ] 验证 localStorage 已保存：打开 DevTools → Application → LocalStorage → `mindmap_api_config`

### 2.3 API 功能验证
- [ ] **配置后使用 API**：点击 AI 功能 → 使用配置的 API 和模型
- [ ] **实时响应**：API 返回内容并显示在编辑器中
- [ ] **错误处理**：错误 API 地址/密钥 → 显示友好错误提示
- [ ] **模型切换**：更改模型 → 重新生成 → 验证使用新模型

---

## 3️⃣ 侧边栏功能测试（关键）

### 3.1 侧边栏展开/折叠
- [ ] 点击左侧栏 **折叠箭头** → 左栏缩小，显示悬浮展开按钮
- [ ] 点击右侧栏 **折叠箭头** → 右栏缩小，显示悬浮展开按钮
- [ ] 悬浮展开按钮显示位置：
  - [ ] 左侧：固定在左边距
  - [ ] 右侧：固定在右边距

### 3.2 侧边栏恢复（修复功能）
- [ ] **点击左侧悬浮按钮** → 左栏重新展开
- [ ] **点击右侧悬浮按钮** → 右栏重新展开
- [ ] 验证面板内容完整显示
- [ ] 再次折叠 → 再次展开 → 循环测试无问题

### 3.3 侧边栏内容
- **左侧栏**（操作历史）：
  - [ ] 显示撤销/重做按钮
  - [ ] 历史列表正常工作
  
- **右侧栏**（节点属性）：
  - [ ] 选中节点 → 右栏显示属性
  - [ ] 修改属性 → 立即生效
  - [ ] 修改样式 → 节点外观改变

---

## 4️⃣ 文件导出/导入测试

### 4.1 导出功能
- [ ] **导出 PNG**：工具栏 → 导出 → PNG → 下载高清图片
- [ ] **导出 JPG**：工具栏 → 导出 → JPG → 下载压缩图片
- [ ] **导出 JSON**：工具栏 → 导出 → JSON → 保存思维导图数据
- [ ] **导出 Markdown**：工具栏 → 导出 → Markdown → 生成大纲文本
- [ ] **导出纯文本**：工具栏 → 导出 → Text → 纯文本输出

### 4.2 导入功能
- [ ] **导入 JSON**：工具栏 → 导入 → 选择 .json 文件 → 导入成功
- [ ] **导入文本**：工具栏 → 导入 → 选择 .txt/.md 文件 → 自动分析结构
- [ ] **导入后验证**：数据完整，结构正确

---

## 5️⃣ 数据持久化测试

### 5.1 自动保存
- [ ] 编辑节点文本 → 自动保存到 localStorage
- [ ] 改变节点颜色 → 自动保存
- [ ] 调整节点位置 → 自动保存
- [ ] 打开浏览器控制台：查看 `localStorage.getItem('mindmap_data')` → 包含最新数据

### 5.2 刷新页面
- [ ] 编辑思维导图后刷新页面（F5）
- [ ] 所有修改都保留
- [ ] 视图缩放/平移状态保留

### 5.3 API 配置保存
- [ ] 配置 API 后刷新页面
- [ ] API 设置仍然存在
- [ ] localStorage key: `mindmap_api_config`

---

## 6️⃣ 用户界面测试

### 6.1 工具栏功能
- [ ] **创建节点**：按钮有效
- [ ] **删除节点**：按钮有效
- [ ] **居中视图**：按钮有效
- [ ] **导出/导入**：菜单展开正常
- [ ] **API 设置**：打开设置弹窗
- [ ] **帮助/文档**：显示使用说明

### 6.2 响应式设计
- [ ] 调整浏览器窗口大小：界面自适应
- [ ] 移动设备访问：界面布局合理（如适用）
- [ ] 所有按钮和输入框易于操作

### 6.3 快捷键
- [ ] **Ctrl+Z**：撤销
- [ ] **Ctrl+Y**：重做
- [ ] **Delete**：删除选中节点
- [ ] **F**：全屏
- [ ] **Enter**：完成编辑

---

## 7️⃣ 性能测试

### 7.1 大数据处理
- [ ] 创建 100+ 个节点：性能仍可接受
- [ ] 快速操作：无卡顿或延迟
- [ ] 浏览器内存占用：< 200MB

### 7.2 长期使用
- [ ] 持续编辑 30 分钟：无内存泄漏
- [ ] 频繁导入/导出：稳定工作
- [ ] 频繁 AI 调用：正常响应

---

## 8️⃣ 文件匹配测试

### 8.1 文件结构验证
```
✅ mindmap.htm           主应用文件（3933 行，包含所有功能）
✅ index.html            重定向入口（现已更新）
✅ css/style.css         样式文件
✅ js/app.js             应用初始化（已同步 mindmap.htm）
✅ js/ai/AIService.js    AI 服务模块（已同步支持自定义模型）
⚠️  其他 js/ 文件        参考/备份，可选使用
```

### 8.2 功能完整性检查
- [ ] mindmap.htm 包含所有 10+ 个类的完整实现
- [ ] 所有 AI 功能在 mindmap.htm 中有对应实现
- [ ] API 配置支持自定义模型和端点

---

## 9️⃣ 故障排查

### 问题：侧栏展开按钮不显示
**解决**：
1. 检查 CSS（style.css）包含 `.panel-expand-btn` 样式
2. 打开 DevTools → 检查 DOM 中是否有 `expand-left-panel` 和 `expand-right-panel` 元素
3. 检查控制台是否有 JavaScript 错误
4. 刷新页面（Ctrl+Shift+Del 清除缓存后刷新）

### 问题：AI 功能无反应
**解决**：
1. 检查浏览器控制台错误信息
2. 如果需要 API：检查 API 配置是否正确
3. 测试 API 连接：点击"测试连接"按钮
4. 使用本地模式：不配置 API 仍能使用

### 问题：localStorage 数据丢失
**解决**：
1. 检查浏览器隐私设置是否允许 localStorage
2. 检查浏览器存储限制（通常 5-10MB）
3. 清除浏览器缓存后重试
4. 使用 DevTools → Application → Clear site data

### 问题：API 返回错误
**解决**：
1. 验证 API 地址格式正确（包括完整路径）
2. 检查 API 密钥有效性
3. 确认选择的模型存在于 API 服务
4. 检查网络连接
5. 查看错误信息获取详细诊断

---

## 🎯 测试完成清单

### 必测项（关键功能）
- [ ] 应用启动正常
- [ ] 节点创建、编辑、删除工作
- [ ] **侧栏折叠/展开功能正常**（修复项）
- [ ] **API 支持自定义模型**（功能确认）
- [ ] 数据自动保存和恢复

### 重要项（核心功能）
- [ ] AI 分析、扩展、优化工作
- [ ] 导出/导入功能完整
- [ ] 主题切换和视图操作
- [ ] 快捷键正常工作

### 优化项（用户体验）
- [ ] 界面响应速度
- [ ] 错误提示清晰
- [ ] 文档和帮助完善

---

## 📞 反馈

如发现任何问题或不清楚的地方，请：
1. 记录问题步骤和错误信息
2. 检查浏览器控制台错误日志
3. 参考故障排查部分
4. 提交详细反馈

---

**版本**: 1.0  
**最后更新**: 2024年  
**维护者**: MindFlow Pro 团队
